# SCHÉMA POSTGRESQL

**Date** : 2025-10-17T17:36:14.945572

**Base** : payroll_db

**Version** : PostgreSQL 17.6 on x86_64-windows, compiled by msvc-19.44.35213, 64-bit

## Tables (23)

- `core.budget_posts` - Aucun commentaire
- `core.employee_job_history` - Aucun commentaire
- `core.employees` - RÃ©fÃ©rentiel unique employÃ©s (dimension)
- `core.job_categories` - Aucun commentaire
- `core.job_codes` - Aucun commentaire
- `core.pay_codes` - Aucun commentaire
- `payroll.budget_posts` - Aucun commentaire
- `payroll.import_batches` - Historique imports (audit/traÃ§abilitÃ©)
- `payroll.import_log` - Log détaillé alertes import (non bloquant)
- `payroll.import_runs` - Historique des imports (traçabilité)
- `payroll.imported_payroll_master` - Aucun commentaire
- `payroll.kpi_snapshot` - Aucun commentaire
- `payroll.pay_periods` - Aucun commentaire
- `payroll.payroll_transactions` - Fait paie (partitionnÃ© par annÃ©e sur pay_date)
- `payroll.payroll_transactions_2024` - Partition annÃ©e 2024
- `payroll.payroll_transactions_2025` - Partition annÃ©e 2025
- `payroll.payroll_transactions_2026` - Partition annÃ©e 2026
- `payroll.stg_imported_payroll` - Staging import (temporaire, nettoyÃ© aprÃ¨s validation)
- `public.alembic_version` - Aucun commentaire
- `reference.budget_posts` - Aucun commentaire
- `reference.pay_code_mappings` - Aucun commentaire
- `reference.pay_codes` - RÃ©fÃ©rentiel codes de paie
- `reference.sign_policies` - Aucun commentaire

## Vues (4)

- `core.v_employees_enriched`
- `payroll.v_imported_payroll`
- `payroll.v_imported_payroll_compat`
- `payroll.v_nouveaux_par_batch`

## Fonctions (278)

- `core.compute_employee_key` (plpgsql)
- `core.immutable_unaccent` (plpgsql)
- `core.update_timestamp` (plpgsql)
- `core.update_updated_at_column` (plpgsql)
- `payroll.auto_calc_period_seq` (plpgsql)
- `payroll.check_pay_date_consistency` (plpgsql)
- `payroll.check_transaction_pay_date` (plpgsql)
- `payroll.ensure_period` (plpgsql)
- `payroll.get_stats_nouveaux_date` (plpgsql)
- `public.armor` (c)
- `public.armor` (c)
- `public.cash_dist` (c)
- `public.crypt` (c)
- `public.date_dist` (c)
- `public.dearmor` (c)
- `public.decrypt` (c)
- `public.decrypt_iv` (c)
- `public.digest` (c)
- `public.digest` (c)
- `public.encrypt` (c)
- `public.encrypt_iv` (c)
- `public.float4_dist` (c)
- `public.float8_dist` (c)
- `public.gbt_bit_compress` (c)
- `public.gbt_bit_consistent` (c)
- `public.gbt_bit_penalty` (c)
- `public.gbt_bit_picksplit` (c)
- `public.gbt_bit_same` (c)
- `public.gbt_bit_union` (c)
- `public.gbt_bool_compress` (c)
- `public.gbt_bool_consistent` (c)
- `public.gbt_bool_fetch` (c)
- `public.gbt_bool_penalty` (c)
- `public.gbt_bool_picksplit` (c)
- `public.gbt_bool_same` (c)
- `public.gbt_bool_union` (c)
- `public.gbt_bpchar_compress` (c)
- `public.gbt_bpchar_consistent` (c)
- `public.gbt_bytea_compress` (c)
- `public.gbt_bytea_consistent` (c)
- `public.gbt_bytea_penalty` (c)
- `public.gbt_bytea_picksplit` (c)
- `public.gbt_bytea_same` (c)
- `public.gbt_bytea_union` (c)
- `public.gbt_cash_compress` (c)
- `public.gbt_cash_consistent` (c)
- `public.gbt_cash_distance` (c)
- `public.gbt_cash_fetch` (c)
- `public.gbt_cash_penalty` (c)
- `public.gbt_cash_picksplit` (c)
- `public.gbt_cash_same` (c)
- `public.gbt_cash_union` (c)
- `public.gbt_date_compress` (c)
- `public.gbt_date_consistent` (c)
- `public.gbt_date_distance` (c)
- `public.gbt_date_fetch` (c)
- `public.gbt_date_penalty` (c)
- `public.gbt_date_picksplit` (c)
- `public.gbt_date_same` (c)
- `public.gbt_date_union` (c)
- `public.gbt_decompress` (c)
- `public.gbt_enum_compress` (c)
- `public.gbt_enum_consistent` (c)
- `public.gbt_enum_fetch` (c)
- `public.gbt_enum_penalty` (c)
- `public.gbt_enum_picksplit` (c)
- `public.gbt_enum_same` (c)
- `public.gbt_enum_union` (c)
- `public.gbt_float4_compress` (c)
- `public.gbt_float4_consistent` (c)
- `public.gbt_float4_distance` (c)
- `public.gbt_float4_fetch` (c)
- `public.gbt_float4_penalty` (c)
- `public.gbt_float4_picksplit` (c)
- `public.gbt_float4_same` (c)
- `public.gbt_float4_union` (c)
- `public.gbt_float8_compress` (c)
- `public.gbt_float8_consistent` (c)
- `public.gbt_float8_distance` (c)
- `public.gbt_float8_fetch` (c)
- `public.gbt_float8_penalty` (c)
- `public.gbt_float8_picksplit` (c)
- `public.gbt_float8_same` (c)
- `public.gbt_float8_union` (c)
- `public.gbt_inet_compress` (c)
- `public.gbt_inet_consistent` (c)
- `public.gbt_inet_penalty` (c)
- `public.gbt_inet_picksplit` (c)
- `public.gbt_inet_same` (c)
- `public.gbt_inet_union` (c)
- `public.gbt_int2_compress` (c)
- `public.gbt_int2_consistent` (c)
- `public.gbt_int2_distance` (c)
- `public.gbt_int2_fetch` (c)
- `public.gbt_int2_penalty` (c)
- `public.gbt_int2_picksplit` (c)
- `public.gbt_int2_same` (c)
- `public.gbt_int2_union` (c)
- `public.gbt_int4_compress` (c)
- `public.gbt_int4_consistent` (c)
- `public.gbt_int4_distance` (c)
- `public.gbt_int4_fetch` (c)
- `public.gbt_int4_penalty` (c)
- `public.gbt_int4_picksplit` (c)
- `public.gbt_int4_same` (c)
- `public.gbt_int4_union` (c)
- `public.gbt_int8_compress` (c)
- `public.gbt_int8_consistent` (c)
- `public.gbt_int8_distance` (c)
- `public.gbt_int8_fetch` (c)
- `public.gbt_int8_penalty` (c)
- `public.gbt_int8_picksplit` (c)
- `public.gbt_int8_same` (c)
- `public.gbt_int8_union` (c)
- `public.gbt_intv_compress` (c)
- `public.gbt_intv_consistent` (c)
- `public.gbt_intv_decompress` (c)
- `public.gbt_intv_distance` (c)
- `public.gbt_intv_fetch` (c)
- `public.gbt_intv_penalty` (c)
- `public.gbt_intv_picksplit` (c)
- `public.gbt_intv_same` (c)
- `public.gbt_intv_union` (c)
- `public.gbt_macad8_compress` (c)
- `public.gbt_macad8_consistent` (c)
- `public.gbt_macad8_fetch` (c)
- `public.gbt_macad8_penalty` (c)
- `public.gbt_macad8_picksplit` (c)
- `public.gbt_macad8_same` (c)
- `public.gbt_macad8_union` (c)
- `public.gbt_macad_compress` (c)
- `public.gbt_macad_consistent` (c)
- `public.gbt_macad_fetch` (c)
- `public.gbt_macad_penalty` (c)
- `public.gbt_macad_picksplit` (c)
- `public.gbt_macad_same` (c)
- `public.gbt_macad_union` (c)
- `public.gbt_numeric_compress` (c)
- `public.gbt_numeric_consistent` (c)
- `public.gbt_numeric_penalty` (c)
- `public.gbt_numeric_picksplit` (c)
- `public.gbt_numeric_same` (c)
- `public.gbt_numeric_union` (c)
- `public.gbt_oid_compress` (c)
- `public.gbt_oid_consistent` (c)
- `public.gbt_oid_distance` (c)
- `public.gbt_oid_fetch` (c)
- `public.gbt_oid_penalty` (c)
- `public.gbt_oid_picksplit` (c)
- `public.gbt_oid_same` (c)
- `public.gbt_oid_union` (c)
- `public.gbt_text_compress` (c)
- `public.gbt_text_consistent` (c)
- `public.gbt_text_penalty` (c)
- `public.gbt_text_picksplit` (c)
- `public.gbt_text_same` (c)
- `public.gbt_text_union` (c)
- `public.gbt_time_compress` (c)
- `public.gbt_time_consistent` (c)
- `public.gbt_time_distance` (c)
- `public.gbt_time_fetch` (c)
- `public.gbt_time_penalty` (c)
- `public.gbt_time_picksplit` (c)
- `public.gbt_time_same` (c)
- `public.gbt_time_union` (c)
- `public.gbt_timetz_compress` (c)
- `public.gbt_timetz_consistent` (c)
- `public.gbt_ts_compress` (c)
- `public.gbt_ts_consistent` (c)
- `public.gbt_ts_distance` (c)
- `public.gbt_ts_fetch` (c)
- `public.gbt_ts_penalty` (c)
- `public.gbt_ts_picksplit` (c)
- `public.gbt_ts_same` (c)
- `public.gbt_ts_union` (c)
- `public.gbt_tstz_compress` (c)
- `public.gbt_tstz_consistent` (c)
- `public.gbt_tstz_distance` (c)
- `public.gbt_uuid_compress` (c)
- `public.gbt_uuid_consistent` (c)
- `public.gbt_uuid_fetch` (c)
- `public.gbt_uuid_penalty` (c)
- `public.gbt_uuid_picksplit` (c)
- `public.gbt_uuid_same` (c)
- `public.gbt_uuid_union` (c)
- `public.gbt_var_decompress` (c)
- `public.gbt_var_fetch` (c)
- `public.gbtreekey16_in` (c)
- `public.gbtreekey16_out` (c)
- `public.gbtreekey2_in` (c)
- `public.gbtreekey2_out` (c)
- `public.gbtreekey32_in` (c)
- `public.gbtreekey32_out` (c)
- `public.gbtreekey4_in` (c)
- `public.gbtreekey4_out` (c)
- `public.gbtreekey8_in` (c)
- `public.gbtreekey8_out` (c)
- `public.gbtreekey_var_in` (c)
- `public.gbtreekey_var_out` (c)
- `public.gen_random_bytes` (c)
- `public.gen_random_uuid` (c)
- `public.gen_salt` (c)
- `public.gen_salt` (c)
- `public.gin_extract_query_trgm` (c)
- `public.gin_extract_value_trgm` (c)
- `public.gin_trgm_consistent` (c)
- `public.gin_trgm_triconsistent` (c)
- `public.gtrgm_compress` (c)
- `public.gtrgm_consistent` (c)
- `public.gtrgm_decompress` (c)
- `public.gtrgm_distance` (c)
- `public.gtrgm_in` (c)
- `public.gtrgm_options` (c)
- `public.gtrgm_out` (c)
- `public.gtrgm_penalty` (c)
- `public.gtrgm_picksplit` (c)
- `public.gtrgm_same` (c)
- `public.gtrgm_union` (c)
- `public.hmac` (c)
- `public.hmac` (c)
- `public.int2_dist` (c)
- `public.int4_dist` (c)
- `public.int8_dist` (c)
- `public.interval_dist` (c)
- `public.oid_dist` (c)
- `public.pgp_armor_headers` (c)
- `public.pgp_key_id` (c)
- `public.pgp_pub_decrypt` (c)
- `public.pgp_pub_decrypt` (c)
- `public.pgp_pub_decrypt` (c)
- `public.pgp_pub_decrypt_bytea` (c)
- `public.pgp_pub_decrypt_bytea` (c)
- `public.pgp_pub_decrypt_bytea` (c)
- `public.pgp_pub_encrypt` (c)
- `public.pgp_pub_encrypt` (c)
- `public.pgp_pub_encrypt_bytea` (c)
- `public.pgp_pub_encrypt_bytea` (c)
- `public.pgp_sym_decrypt` (c)
- `public.pgp_sym_decrypt` (c)
- `public.pgp_sym_decrypt_bytea` (c)
- `public.pgp_sym_decrypt_bytea` (c)
- `public.pgp_sym_encrypt` (c)
- `public.pgp_sym_encrypt` (c)
- `public.pgp_sym_encrypt_bytea` (c)
- `public.pgp_sym_encrypt_bytea` (c)
- `public.set_limit` (c)
- `public.show_limit` (c)
- `public.show_trgm` (c)
- `public.similarity` (c)
- `public.similarity_dist` (c)
- `public.similarity_op` (c)
- `public.strict_word_similarity` (c)
- `public.strict_word_similarity_commutator_op` (c)
- `public.strict_word_similarity_dist_commutator_op` (c)
- `public.strict_word_similarity_dist_op` (c)
- `public.strict_word_similarity_op` (c)
- `public.time_dist` (c)
- `public.ts_dist` (c)
- `public.tstz_dist` (c)
- `public.unaccent` (c)
- `public.unaccent` (c)
- `public.unaccent_init` (c)
- `public.unaccent_lexize` (c)
- `public.uuid_generate_v1` (c)
- `public.uuid_generate_v1mc` (c)
- `public.uuid_generate_v3` (c)
- `public.uuid_generate_v4` (c)
- `public.uuid_generate_v5` (c)
- `public.uuid_nil` (c)
- `public.uuid_ns_dns` (c)
- `public.uuid_ns_oid` (c)
- `public.uuid_ns_url` (c)
- `public.uuid_ns_x500` (c)
- `public.word_similarity` (c)
- `public.word_similarity_commutator_op` (c)
- `public.word_similarity_dist_commutator_op` (c)
- `public.word_similarity_dist_op` (c)
- `public.word_similarity_op` (c)

## Colonnes (extrait)

### Schéma core


**core.budget_posts**
- `budget_post_id` : integer (NO)
- `code` : character varying (NO)
- `description` : character varying (YES)
- `active` : boolean (NO)
- `created_at` : timestamp with time zone (NO)

**core.employee_job_history**
- `history_id` : uuid (NO)
- `employee_id` : uuid (NO)
- `code_id` : integer (NO)
- `date_debut` : date (NO)
- `date_fin` : date (YES)
- `created_at` : timestamp with time zone (NO)

**core.employees**
- `employee_id` : integer (NO)
- `employee_key` : character varying (NO)
- `matricule_norm` : character varying (YES)
- `matricule_raw` : character varying (YES)
- `nom_norm` : character varying (NO)
- `prenom_norm` : character varying (YES)
- `nom_complet` : character varying (YES)
- `statut` : character varying (YES)
- `source_system` : character varying (YES)
- `created_at` : timestamp with time zone (YES)
- `updated_at` : timestamp with time zone (YES)
- `created_by` : character varying (YES)
- `updated_by` : character varying (YES)

**core.job_categories**
- `category_id` : integer (NO)
- `nom` : character varying (NO)
- `description` : text (YES)
- `active` : boolean (NO)
- `created_at` : timestamp with time zone (NO)

**core.job_codes**
- `code_id` : integer (NO)
- `code` : character varying (NO)
- `titre` : character varying (NO)
- `category_id` : integer (YES)
- `active` : boolean (NO)
- `created_at` : timestamp with time zone (NO)

**core.pay_codes**
- `pay_code` : character varying (NO)
- `label` : character varying (NO)
- `category` : character varying (NO)
- `active` : boolean (NO)
- `created_at` : timestamp with time zone (NO)

**core.v_employees_enriched**
- `employee_id` : integer (YES)
- `employee_key` : character varying (YES)
- `matricule_norm` : character varying (YES)
- `matricule_raw` : character varying (YES)
- `nom_norm` : character varying (YES)
- `prenom_norm` : character varying (YES)
- `nom_complet` : character varying (YES)
- `statut` : character varying (YES)
- `source_system` : character varying (YES)
- `created_at` : timestamp with time zone (YES)
### Schéma payroll


**payroll.budget_posts**
- `post_id` : integer (NO)
- `code` : text (YES)
- `description` : text (YES)
- `category` : text (YES)
- `is_active` : boolean (YES)

**payroll.import_batches**
- `batch_id` : integer (NO)
- `batch_uuid` : uuid (YES)
- `filename` : character varying (YES)
- `file_checksum` : character varying (YES)
- `total_rows` : integer (YES)
- `valid_rows` : integer (YES)
- `invalid_rows` : integer (YES)
- `new_employees` : integer (YES)
- `new_transactions` : integer (YES)
- `status` : character varying (YES)
- `error_message` : text (YES)
- `started_at` : timestamp with time zone (YES)
- `completed_at` : timestamp with time zone (YES)
- `created_by` : character varying (YES)

**payroll.imported_payroll_master**
- `id` : bigint (NO)
- `N de ligne ` : integer (YES)
- `Categorie d'emploi` : text (YES)
- `code emploi` : text (YES)
- `titre d'emploi` : text (YES)
- `date de paie ` : date (NO)
- `matricule ` : text (YES)
- `employé ` : text (YES)
- `categorie de paie ` : text (YES)
- `code de paie ` : text (YES)
- `desc code de paie ` : text (YES)
- `poste Budgetaire ` : text (YES)
- `desc poste Budgétaire ` : text (YES)
- `montant ` : numeric (YES)
- `part employeur ` : text (YES)
- `Mnt/Cmb` : text (YES)
- `source_file` : text (YES)
- `source_row_number` : integer (YES)
- `imported_at` : timestamp without time zone (YES)

**payroll.kpi_snapshot**
- `period` : character varying (NO)
- `period_id` : uuid (YES)
- `data` : jsonb (NO)
- `calculated_at` : timestamp with time zone (NO)
- `row_count` : integer (NO)

**payroll.pay_periods**
- `period_id` : uuid (NO)
- `pay_date` : date (NO)
- `pay_day` : integer (NO)
- `pay_month` : integer (NO)
- `pay_year` : integer (NO)
- `period_seq_in_year` : integer (NO)
- `status` : character varying (NO)
